-- Combined script with no UI

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local VirtualInputManager = game:GetService("VirtualInputManager")

-- Function to unequip all pets
local function unequipAllPets()
    local petsFolder = LocalPlayer.petsFolder
    for _, folder in pairs(petsFolder:GetChildren()) do
        if folder:IsA("Folder") then
            for _, pet in pairs(folder:GetChildren()) do
                ReplicatedStorage.rEvents.equipPetEvent:FireServer("unequipPet", pet)
            end
        end
    end
    task.wait(0.1)
end

-- Function to equip specific pet
local function equipPet(petName)
    unequipAllPets()
    task.wait(0.01)
    for _, pet in pairs(LocalPlayer.petsFolder.Unique:GetChildren()) do
        if pet.Name == petName then
            ReplicatedStorage.rEvents.equipPetEvent:FireServer("equipPet", pet)
        end
    end
end

-- Function to find machine
local function findMachine(machineName)
    local machine = workspace.machinesFolder:FindFirstChild(machineName)
    if not machine then
        for _, folder in pairs(workspace:GetChildren()) do
            if folder:IsA("Folder") and folder.Name:find("machines") then
                machine = folder:FindFirstChild(machineName)
                if machine then break end
            end
        end
    end
    return machine
end

-- Function to press E key
local function pressE()
    VirtualInputManager:SendKeyEvent(true, "E", false, game)
    task.wait(0.1)
    VirtualInputManager:SendKeyEvent(false, "E", false, game)
end

-- Auto rebirth system
task.spawn(function()
    while true do
        local rebirthsValue = LocalPlayer.leaderstats.Rebirths.Value
        local strengthNeeded = 10000 + (5000 * rebirthsValue)
        
        if LocalPlayer.ultimatesFolder:FindFirstChild("Golden Rebirth") then
            local goldenRebirthValue = LocalPlayer.ultimatesFolder["Golden Rebirth"].Value
            strengthNeeded = math.floor(strengthNeeded * (1 - (goldenRebirthValue * 0.1)))
        end
        
        unequipAllPets()
        task.wait(0.1)
        equipPet("Swift Samurai")
        
        while LocalPlayer.leaderstats.Strength.Value < strengthNeeded do
            for i = 1, 10 do
                LocalPlayer.muscleEvent:FireServer("rep")
            end
            task.wait()
        end
        
        unequipAllPets()
        task.wait(0.1)
        equipPet("Tribal Overlord")
        
        local jungleBar = findMachine("Jungle Bar Lift")
        if jungleBar and jungleBar:FindFirstChild("interactSeat") then
            LocalPlayer.Character.HumanoidRootPart.CFrame = jungleBar.interactSeat.CFrame * CFrame.new(0, 3, 0)
            repeat
                task.wait(0.1)
                pressE()
            until LocalPlayer.Character.Humanoid.Sit
        end
        
        local currentRebirths = LocalPlayer.leaderstats.Rebirths.Value
        repeat
            ReplicatedStorage.rEvents.rebirthRemote:InvokeServer("rebirthRequest")
            task.wait(0.1)
        until LocalPlayer.leaderstats.Rebirths.Value > currentRebirths
        
        task.wait()
    end
end)

-- Hide all frames
task.spawn(function()
    for _, obj in pairs(ReplicatedStorage:GetChildren()) do
        if obj.Name:match("Frame$") then
            obj.Visible = false
        end
    end
end)

-- Auto use protein egg
_G.AutoEgg = true
task.spawn(function()
    while true do
        if _G.AutoEgg then
            local proteinEgg = LocalPlayer.Backpack:FindFirstChild("Protein Egg")
            if proteinEgg then
                proteinEgg.Parent = LocalPlayer.Character
                for i = 1, 5 do
                    VirtualInputManager:SendMouseButtonEvent(0, 0, 0, true, game, 1)
                    task.wait()
                    VirtualInputManager:SendMouseButtonEvent(0, 0, 0, false, game, 1)
                    task.wait(0.1)
                end
            end
        end
        task.wait(1)
    end
end)
